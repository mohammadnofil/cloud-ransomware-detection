<svg width="1200" height="800" viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1200" height="800" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" font-size="24" font-weight="bold" fill="#1a73e8">
    GCP Ransomware Detection & Response System
  </text>
  
  <!-- Cloud Storage Bucket -->
  <g transform="translate(50, 80)">
    <rect x="0" y="0" width="140" height="80" rx="8" fill="#4285f4" stroke="#1a73e8" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Cloud Storage</text>
    <text x="70" y="40" text-anchor="middle" font-size="10" fill="white">Main Bucket</text>
    <text x="70" y="55" text-anchor="middle" font-size="8" fill="white">bucket-ransomware-</text>
    <text x="70" y="68" text-anchor="middle" font-size="8" fill="white">detection-456017</text>
  </g>
  
  <!-- Backup Bucket -->
  <g transform="translate(50, 200)">
    <rect x="0" y="0" width="140" height="60" rx="8" fill="#34a853" stroke="#137333" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Backup Storage</text>
    <text x="70" y="40" text-anchor="middle" font-size="10" fill="white">Daily Snapshots</text>
  </g>
  
  <!-- VM Instance -->
  <g transform="translate(50, 300)">
    <rect x="0" y="0" width="140" height="80" rx="8" fill="#ea4335" stroke="#d33b2c" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Compute Engine</text>
    <text x="70" y="40" text-anchor="middle" font-size="10" fill="white">VM Instance</text>
    <text x="70" y="55" text-anchor="middle" font-size="8" fill="white">ransomware-vm</text>
  </g>
  
  <!-- Cloud Functions -->
  <g transform="translate(300, 120)">
    <rect x="0" y="0" width="160" height="200" rx="8" fill="#fbbc04" stroke="#f9ab00" stroke-width="2"/>
    <text x="80" y="20" text-anchor="middle" font-size="14" font-weight="bold" fill="#1a1a1a">Cloud Functions</text>
    
    <!-- Function 1 -->
    <rect x="10" y="35" width="140" height="45" rx="4" fill="white" stroke="#f9ab00"/>
    <text x="80" y="50" text-anchor="middle" font-size="10" font-weight="bold">Ransomware Detection</text>
    <text x="80" y="65" text-anchor="middle" font-size="8">detect_ransomware</text>
    
    <!-- Function 2 -->
    <rect x="10" y="90" width="140" height="45" rx="4" fill="white" stroke="#f9ab00"/>
    <text x="80" y="105" text-anchor="middle" font-size="10" font-weight="bold">VM Isolation</text>
    <text x="80" y="120" text-anchor="middle" font-size="8">isolate_vm</text>
    
    <!-- Function 3 -->
    <rect x="10" y="145" width="140" height="45" rx="4" fill="white" stroke="#f9ab00"/>
    <text x="80" y="160" text-anchor="middle" font-size="10" font-weight="bold">Backup Files</text>
    <text x="80" y="175" text-anchor="middle" font-size="8">backup_files</text>
  </g>
  
  <!-- Cloud Logging -->
  <g transform="translate(550, 80)">
    <rect x="0" y="0" width="140" height="80" rx="8" fill="#9aa0a6" stroke="#5f6368" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Cloud Logging</text>
    <text x="70" y="40" text-anchor="middle" font-size="10" fill="white">Log-based Metrics</text>
    <text x="70" y="55" text-anchor="middle" font-size="8" fill="white">File Activity Tracking</text>
  </g>
  
  <!-- Cloud Monitoring -->
  <g transform="translate(550, 200)">
    <rect x="0" y="0" width="140" height="80" rx="8" fill="#ff6d01" stroke="#e8710a" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Cloud Monitoring</text>
    <text x="70" y="40" text-anchor="middle" font-size="10" fill="white">Alert Policies</text>
    <text x="70" y="55" text-anchor="middle" font-size="8" fill="white">Threshold: >1 file/min</text>
  </g>
  
  <!-- Pub/Sub -->
  <g transform="translate(550, 320)">
    <rect x="0" y="0" width="140" height="60" rx="8" fill="#4285f4" stroke="#1a73e8" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Pub/Sub</text>
    <text x="70" y="40" text-anchor="middle" font-size="10" fill="white">ransomware-alerts</text>
  </g>
  
  <!-- Cloud Scheduler -->
  <g transform="translate(800, 80)">
    <rect x="0" y="0" width="140" height="80" rx="8" fill="#34a853" stroke="#137333" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Cloud Scheduler</text>
    <text x="70" y="40" text-anchor="middle" font-size="10" fill="white">Daily Backup</text>
    <text x="70" y="55" text-anchor="middle" font-size="8" fill="white">Cron: 0 0 * * *</text>
  </g>
  
  <!-- Notification Channels -->
  <g transform="translate(800, 200)">
    <rect x="0" y="0" width="140" height="100" rx="8" fill="#9334e9" stroke="#7c3aed" stroke-width="2"/>
    <text x="70" y="20" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Notifications</text>
    
    <circle cx="30" cy="40" r="8" fill="white"/>
    <text x="30" y="45" text-anchor="middle" font-size="8">ðŸ“§</text>
    <text x="70" y="45" text-anchor="middle" font-size="8" fill="white">Email</text>
    
    <circle cx="30" cy="60" r="8" fill="white"/>
    <text x="30" y="65" text-anchor="middle" font-size="8">ðŸ“±</text>
    <text x="70" y="65" text-anchor="middle" font-size="8" fill="white">SMS</text>
    
    <circle cx="30" cy="80" r="8" fill="white"/>
    <text x="30" y="85" text-anchor="middle" font-size="8">ðŸ””</text>
    <text x="70" y="85" text-anchor="middle" font-size="8" fill="white">Security Team</text>
  </g>
  
  <!-- Firewall -->
  <g transform="translate(800, 340)">
    <rect x="0" y="0" width="140" height="60" rx="8" fill="#ea4335" stroke="#d33b2c" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Firewall Rules</text>
    <text x="70" y="40" text-anchor="middle" font-size="10" fill="white">Network Security</text>
  </g>
  
  <!-- IAM -->
  <g transform="translate(1000, 80)">
    <rect x="0" y="0" width="140" height="80" rx="8" fill="#5f6368" stroke="#3c4043" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="white">IAM & Admin</text>
    <text x="70" y="40" text-anchor="middle" font-size="10" fill="white">Access Control</text>
    <text x="70" y="55" text-anchor="middle" font-size="8" fill="white">Service Accounts</text>
  </g>
  
  <!-- Security Command Center -->
  <g transform="translate(1000, 200)">
    <rect x="0" y="0" width="140" height="80" rx="8" fill="#0d652d" stroke="#137333" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Security Command</text>
    <text x="70" y="40" text-anchor="middle" font-size="10" fill="white">Center</text>
    <text x="70" y="55" text-anchor="middle" font-size="8" fill="white">Threat Detection</text>
  </g>
  
  <!-- Arrows and Flow -->
  <!-- Storage to Functions -->
  <path d="M 190 120 L 290 140" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="240" y="125" font-size="8" fill="#333">File Upload Trigger</text>
  
  <!-- Functions to Logging -->
  <path d="M 460 160 L 540 120" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Logging to Monitoring -->
  <path d="M 620 160 L 620 190" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Monitoring to Pub/Sub -->
  <path d="M 620 280 L 620 310" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="630" y="295" font-size="8" fill="#333">Alert Triggered</text>
  
  <!-- Pub/Sub to Functions -->
  <path d="M 550 350 L 460 250" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="490" y="300" font-size="8" fill="#333">Isolate VM</text>
  
  <!-- Pub/Sub to Notifications -->
  <path d="M 690 350 L 790 250" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Scheduler to Functions -->
  <path d="M 800 120 L 460 180" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="630" y="140" font-size="8" fill="#333">Daily Backup</text>
  
  <!-- Functions to VM -->
  <path d="M 300 320 L 190 340" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="200" y="325" font-size="8" fill="#333">VM Isolation</text>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
  
  <!-- Flow Legend -->
  <g transform="translate(50, 500)">
    <rect x="0" y="0" width="1100" height="280" rx="8" fill="white" stroke="#ddd" stroke-width="1"/>
    <text x="20" y="25" font-size="16" font-weight="bold" fill="#1a73e8">System Flow & Response Process</text>
    
    <!-- Normal Flow -->
    <text x="20" y="50" font-size="12" font-weight="bold" fill="#34a853">1. Normal Operation:</text>
    <text x="30" y="70" font-size="10">â€¢ Cloud Scheduler triggers daily backup at 12:00 AM</text>
    <text x="30" y="85" font-size="10">â€¢ VM snapshots are created and stored in backup bucket</text>
    <text x="30" y="100" font-size="10">â€¢ Cloud Logging monitors all file activities in main bucket</text>
    
    <!-- Detection Flow -->
    <text x="20" y="125" font-size="12" font-weight="bold" fill="#ea4335">2. Ransomware Detection:</text>
    <text x="30" y="145" font-size="10">â€¢ Suspicious file uploaded to Cloud Storage bucket</text>
    <text x="30" y="160" font-size="10">â€¢ Cloud Function 'detect_ransomware' analyzes file patterns</text>
    <text x="30" y="175" font-size="10">â€¢ Log-based metrics track file insertion rate (>1 file/min threshold)</text>
    <text x="30" y="190" font-size="10">â€¢ Cloud Monitoring triggers alert policy when threshold exceeded</text>
    
    <!-- Response Flow -->
    <text x="20" y="215" font-size="12" font-weight="bold" fill="#ff6d01">3. Automated Response:</text>
    <text x="30" y="235" font-size="10">â€¢ Alert policy publishes message to Pub/Sub topic 'ransomware-alerts'</text>
    <text x="30" y="250" font-size="10">â€¢ Cloud Function 'isolate_vm' immediately isolates affected VM instance</text>
    <text x="30" y="265" font-size="10">â€¢ Notification channels send alerts to security team (Email, SMS, Pub/Sub)</text>
    
    <!-- Recovery -->
    <text x="600" y="50" font-size="12" font-weight="bold" fill="#9334e9">4. Recovery Process:</text>
    <text x="610" y="70" font-size="10">â€¢ Security team receives immediate notifications</text>
    <text x="610" y="85" font-size="10">â€¢ Firewall rules block suspicious outbound traffic</text>
    <text x="610" y="100" font-size="10">â€¢ Cloud versioning enables file recovery from backup</text>
    <text x="610" y="115" font-size="10">â€¢ IAM policies restrict unauthorized access</text>
    
    <!-- Security Features -->
    <text x="600" y="140" font-size="12" font-weight="bold" fill="#5f6368">5. Security Features:</text>
    <text x="610" y="160" font-size="10">â€¢ Security Command Center provides centralized threat visibility</text>
    <text x="610" y="175" font-size="10">â€¢ Data Access logs track all admin and data operations</text>
    <text x="610" y="190" font-size="10">â€¢ Service account permissions follow principle of least privilege</text>
    <text x="610" y="205" font-size="10">â€¢ Multi-layered defense with proactive threat detection</text>
  </g>
  
</svg>