<svg width="1200" height="900" viewBox="0 0 1200 900" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1200" height="900" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" font-size="24" font-weight="bold" fill="#1a73e8">
    Ransomware Detection System - Data Flow Diagram
  </text>
  
  <!-- External Entities -->
  <!-- User/Attacker -->
  <g transform="translate(50, 80)">
    <rect x="0" y="0" width="120" height="60" rx="30" fill="#ea4335" stroke="#d33b2c" stroke-width="3"/>
    <text x="60" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="white">User/Attacker</text>
    <text x="60" y="40" text-anchor="middle" font-size="10" fill="white">(External Entity)</text>
  </g>
  
  <!-- Security Team -->
  <g transform="translate(1000, 80)">
    <rect x="0" y="0" width="120" height="60" rx="30" fill="#34a853" stroke="#137333" stroke-width="3"/>
    <text x="60" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Security Team</text>
    <text x="60" y="40" text-anchor="middle" font-size="10" fill="white">(External Entity)</text>
  </g>
  
  <!-- Data Stores -->
  <!-- Main Storage Bucket -->
  <g transform="translate(50, 200)">
    <rect x="0" y="0" width="150" height="60" rx="0" fill="white" stroke="#4285f4" stroke-width="3"/>
    <rect x="10" y="0" width="10" height="60" fill="#4285f4"/>
    <text x="85" y="25" text-anchor="middle" font-size="12" font-weight="bold">D1: Main Storage</text>
    <text x="85" y="40" text-anchor="middle" font-size="10">Cloud Storage Bucket</text>
  </g>
  
  <!-- Backup Storage -->
  <g transform="translate(50, 300)">
    <rect x="0" y="0" width="150" height="60" rx="0" fill="white" stroke="#34a853" stroke-width="3"/>
    <rect x="10" y="0" width="10" height="60" fill="#34a853"/>
    <text x="85" y="25" text-anchor="middle" font-size="12" font-weight="bold">D2: Backup Storage</text>
    <text x="85" y="40" text-anchor="middle" font-size="10">Daily Snapshots</text>
  </g>
  
  <!-- Log Data Store -->
  <g transform="translate(300, 700)">
    <rect x="0" y="0" width="150" height="60" rx="0" fill="white" stroke="#9aa0a6" stroke-width="3"/>
    <rect x="10" y="0" width="10" height="60" fill="#9aa0a6"/>
    <text x="85" y="25" text-anchor="middle" font-size="12" font-weight="bold">D3: Log Repository</text>
    <text x="85" y="40" text-anchor="middle" font-size="10">Cloud Logging</text>
  </g>
  
  <!-- Metrics Data Store -->
  <g transform="translate(550, 700)">
    <rect x="0" y="0" width="150" height="60" rx="0" fill="white" stroke="#ff6d01" stroke-width="3"/>
    <rect x="10" y="0" width="10" height="60" fill="#ff6d01"/>
    <text x="85" y="25" text-anchor="middle" font-size="12" font-weight="bold">D4: Metrics Store</text>
    <text x="85" y="40" text-anchor="middle" font-size="10">Cloud Monitoring</text>
  </g>
  
  <!-- VM Data Store -->
  <g transform="translate(800, 700)">
    <rect x="0" y="0" width="150" height="60" rx="0" fill="white" stroke="#ea4335" stroke-width="3"/>
    <rect x="10" y="0" width="10" height="60" fill="#ea4335"/>
    <text x="85" y="25" text-anchor="middle" font-size="12" font-weight="bold">D5: VM Instance</text>
    <text x="85" y="40" text-anchor="middle" font-size="10">Compute Engine</text>
  </g>
  
  <!-- Processes (Circles) -->
  <!-- File Upload Process -->
  <g transform="translate(300, 200)">
    <circle cx="60" cy="30" r="40" fill="#4285f4" stroke="#1a73e8" stroke-width="3"/>
    <text x="60" y="20" text-anchor="middle" font-size="10" font-weight="bold" fill="white">P1: File Upload</text>
    <text x="60" y="35" text-anchor="middle" font-size="8" fill="white">& Storage</text>
    <text x="60" y="48" text-anchor="middle" font-size="8" fill="white">Management</text>
  </g>
  
  <!-- Ransomware Detection Process -->
  <g transform="translate(500, 300)">
    <circle cx="60" cy="30" r="40" fill="#fbbc04" stroke="#f9ab00" stroke-width="3"/>
    <text x="60" y="20" text-anchor="middle" font-size="10" font-weight="bold">P2: Ransomware</text>
    <text x="60" y="35" text-anchor="middle" font-size="8">Detection &</text>
    <text x="60" y="48" text-anchor="middle" font-size="8">Analysis</text>
  </g>
  
  <!-- Log Processing -->
  <g transform="translate(300, 500)">
    <circle cx="60" cy="30" r="40" fill="#9aa0a6" stroke="#5f6368" stroke-width="3"/>
    <text x="60" y="20" text-anchor="middle" font-size="10" font-weight="bold" fill="white">P3: Log</text>
    <text x="60" y="35" text-anchor="middle" font-size="8" fill="white">Processing &</text>
    <text x="60" y="48" text-anchor="middle" font-size="8" fill="white">Filtering</text>
  </g>
  
  <!-- Monitoring & Alerting -->
  <g transform="translate(600, 500)">
    <circle cx="60" cy="30" r="40" fill="#ff6d01" stroke="#e8710a" stroke-width="3"/>
    <text x="60" y="20" text-anchor="middle" font-size="10" font-weight="bold" fill="white">P4: Monitoring</text>
    <text x="60" y="35" text-anchor="middle" font-size="8" fill="white">& Alert</text>
    <text x="60" y="48" text-anchor="middle" font-size="8" fill="white">Generation</text>
  </g>
  
  <!-- VM Isolation Process -->
  <g transform="translate(800, 500)">
    <circle cx="60" cy="30" r="40" fill="#ea4335" stroke="#d33b2c" stroke-width="3"/>
    <text x="60" y="20" text-anchor="middle" font-size="10" font-weight="bold" fill="white">P5: VM</text>
    <text x="60" y="35" text-anchor="middle" font-size="8" fill="white">Isolation &</text>
    <text x="60" y="48" text-anchor="middle" font-size="8" fill="white">Quarantine</text>
  </g>
  
  <!-- Notification Process -->
  <g transform="translate(900, 300)">
    <circle cx="60" cy="30" r="40" fill="#9334e9" stroke="#7c3aed" stroke-width="3"/>
    <text x="60" y="20" text-anchor="middle" font-size="10" font-weight="bold" fill="white">P6: Alert</text>
    <text x="60" y="35" text-anchor="middle" font-size="8" fill="white">Notification &</text>
    <text x="60" y="48" text-anchor="middle" font-size="8" fill="white">Distribution</text>
  </g>
  
  <!-- Backup Process -->
  <g transform="translate(300, 400)">
    <circle cx="60" cy="30" r="40" fill="#34a853" stroke="#137333" stroke-width="3"/>
    <text x="60" y="20" text-anchor="middle" font-size="10" font-weight="bold" fill="white">P7: Automated</text>
    <text x="60" y="35" text-anchor="middle" font-size="8" fill="white">Backup &</text>
    <text x="60" y="48" text-anchor="middle" font-size="8" fill="white">Scheduling</text>
  </g>
  
  <!-- Data Flows (Arrows with Labels) -->
  
  <!-- User to File Upload -->
  <path d="M 170 110 L 290 210" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="220" y="155" font-size="9" fill="#333" transform="rotate(-25 220 155)">1. Suspicious Files</text>
  <text x="220" y="167" font-size="8" fill="#666" transform="rotate(-25 220 167)">(Ransomware Upload)</text>
  
  <!-- File Upload to Storage -->
  <path d="M 300 230 L 200 230" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="240" y="220" font-size="9" fill="#333" text-anchor="middle">2. Store Files</text>
  
  <!-- Storage to Detection -->
  <path d="M 200 250 L 490 310" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="340" y="275" font-size="9" fill="#333" transform="rotate(-8 340 275)">3. File Metadata</text>
  <text x="340" y="287" font-size="8" fill="#666" transform="rotate(-8 340 287)">(Trigger Event)</text>
  
  <!-- Detection to Log Processing -->
  <path d="M 500 340 L 360 490" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="420" y="405" font-size="9" fill="#333" transform="rotate(35 420 405)">4. Detection Results</text>
  <text x="420" y="417" font-size="8" fill="#666" transform="rotate(35 420 417)">(Analysis Data)</text>
  
  <!-- Log Processing to Log Store -->
  <path d="M 340 540 L 365 700" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="355" y="620" font-size="9" fill="#333" transform="rotate(-85 355 620)">5. Structured</text>
  <text x="345" y="632" font-size="8" fill="#666" transform="rotate(-85 345 632)">Log Data</text>
  
  <!-- Log Processing to Monitoring -->
  <path d="M 400 530 L 590 530" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="495" y="520" font-size="9" fill="#333" text-anchor="middle">6. Log Metrics</text>
  <text x="495" y="545" font-size="8" fill="#666" text-anchor="middle">(Aggregated Data)</text>
  
  <!-- Monitoring to Metrics Store -->
  <path d="M 640 540 L 615 700" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="630" y="620" font-size="9" fill="#333" transform="rotate(85 630 620)">7. Metrics</text>
  <text x="640" y="632" font-size="8" fill="#666" transform="rotate(85 640 632)">Storage</text>
  
  <!-- Monitoring to VM Isolation -->
  <path d="M 700 530 L 790 530" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="745" y="520" font-size="9" fill="#333" text-anchor="middle">8. Isolation Command</text>
  <text x="745" y="545" font-size="8" fill="#666" text-anchor="middle">(If Threshold Exceeded)</text>
  
  <!-- VM Isolation to VM -->
  <path d="M 840 540 L 865 700" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="855" y="620" font-size="9" fill="#333" transform="rotate(-85 855 620)">9. VM Control</text>
  <text x="845" y="632" font-size="8" fill="#666" transform="rotate(-85 845 632)">Commands</text>
  
  <!-- Monitoring to Notification -->
  <path d="M 650 470 L 890 340" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="760" y="395" font-size="9" fill="#333" transform="rotate(30 760 395)">10. Alert Trigger</text>
  <text x="760" y="407" font-size="8" fill="#666" transform="rotate(30 760 407)">(Pub/Sub Message)</text>
  
  <!-- Notification to Security Team -->
  <path d="M 950 280 L 1010 140" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="990" y="200" font-size="9" fill="#333" transform="rotate(65 990 200)">11. Notifications</text>
  <text x="990" y="212" font-size="8" fill="#666" transform="rotate(65 990 212)">(Email, SMS)</text>
  
  <!-- Backup Process flows -->
  <!-- Backup to VM -->
  <path d="M 360 420 L 820 680" stroke="#333" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
  <text x="590" y="540" font-size="9" fill="#34a853" text-anchor="middle">12. VM Snapshot</text>
  <text x="590" y="552" font-size="8" fill="#34a853" text-anchor="middle">(Daily Backup)</text>
  
  <!-- Backup to Backup Storage -->
  <path d="M 300 410 L 200 340" stroke="#333" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
  <text x="240" y="370" font-size="9" fill="#34a853" transform="rotate(45 240 370)">13. Backup Data</text>
  <text x="240" y="382" font-size="8" fill="#34a853" transform="rotate(45 240 382)">(Scheduled)</text>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
  
  <!-- Legend and Data Flow Details -->
  <g transform="translate(50, 800)">
    <rect x="0" y="0" width="1100" height="90" rx="8" fill="white" stroke="#ddd" stroke-width="1"/>
    <text x="20" y="20" font-size="14" font-weight="bold" fill="#1a73e8">Data Flow Legend & Process Details</text>
    
    <!-- Legend Items -->
    <g transform="translate(20, 30)">
      <!-- External Entities -->
      <rect x="0" y="0" width="60" height="25" rx="12" fill="#ea4335" stroke="#d33b2c" stroke-width="2"/>
      <text x="30" y="15" text-anchor="middle" font-size="8" font-weight="bold" fill="white">External Entity</text>
      <text x="80" y="15" font-size="10">External actors (users, security team)</text>
      
      <!-- Processes -->
      <circle cx="230" cy="12" r="12" fill="#4285f4" stroke="#1a73e8" stroke-width="2"/>
      <text x="230" y="16" text-anchor="middle" font-size="7" font-weight="bold" fill="white">P</text>
      <text x="260" y="15" font-size="10">Processing functions/operations</text>
      
      <!-- Data Stores -->
      <rect x="420" y="0" width="60" height="25" rx="0" fill="white" stroke="#4285f4" stroke-width="2"/>
      <rect x="425" y="0" width="5" height="25" fill="#4285f4"/>
      <text x="450" y="15" text-anchor="middle" font-size="8" font-weight="bold">D</text>
      <text x="500" y="15" font-size="10">Data storage repositories</text>
      
      <!-- Solid Lines -->
      <path d="M 620 12 L 680 12" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
      <text x="720" y="15" font-size="10">Real-time data flow</text>
      
      <!-- Dashed Lines -->
      <path d="M 850 12 L 910 12" stroke="#34a853" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
      <text x="950" y="15" font-size="10">Scheduled operations</text>
    </g>
    
    <!-- Flow Summary -->
    <text x="20" y="75" font-size="10" font-weight="bold">Critical Path: </text>
    <text x="100" y="75" font-size="9">File Upload → Detection → Logging → Monitoring → Alert → Isolation & Notification (Real-time response within seconds)</text>
  </g>
  
</svg>